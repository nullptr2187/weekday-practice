<!DOCTYPE html>
<html>

<head>
<style>
body {
  background-color: linen;
}

.centered-div {
    width: 50%;
    height: 25%;
}

h1 {
  color: maroon;
  margin-left: 40px;
}

.grid-container {
  display: grid;
  height: 20vh;
  align-content: bottom;
  grid-template-columns: auto auto auto;
  gap: 10px;
  background-color: linen;
  padding: 10px;
}

.grid-container > div {
  background-color: rgba(255, 255, 255, 0.8);
  text-align: center;
  padding: 20px 0;
  font-size: 30px;
}

audio {
  width: 100vw;
}

</style>
</head>

<body onload="javascript:setup();">
    <script type="text/javascript">
        var guessing = true;
        var current_date = null;

        function stop_sound() {
          let audio = document.getElementById("audio");
          audio.src = "silence.ogg";
        }

        function play_date_sound() {
            var msg = new SpeechSynthesisUtterance();
            msg.text = "June 14, 1703";
            msg.addEventListener("end", event => {
              console.log("speech")
            })

            window.speechSynthesis.speak(msg);
        }

        function random_date(start, end) {
            let date = new Date(start.getTime() + Math.random() * (end.getTime() - start.getTime()));
            if (date.getFullYear() == 2001 && date.getDate() == 11 && date.getMonth() == 8) {
                return random_date(start, end);
            } 
            return date;
        }

        function format_date(date) {
            let months = ["January", "Febuary", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
            let string = months[date.getMonth()] + " " + date.getDate() + ", " + date.getFullYear();
            return string;
        }

        function get_day_string(date) {
          let days = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
          return days[date.getDay()];
        }

        function new_date_string() {
            current_date = random_date(new Date("1700-01-01"), new Date("2100-01-01"));
            let date_string = format_date(current_date);
            document.getElementById("date-element").textContent = date_string;

            if (document.getElementById("tts").checked) {
              var msg = new SpeechSynthesisUtterance();
              msg.text = date_string;
              window.speechSynthesis.speak(msg);
            }
        }

        function audio_action() {
          if (guessing) {

            guessing = false;
          } else {

            guessing = true;
          }
        }

        function setup() {
            guessing = true;
            new_date_string();

            let audio = document.getElementById("audio");
            audio.src = "silence.flac";

            audio.onpause = function() {
              audio_action();
            }

            audio.onplay = function() {
              audio_action();
            }
        }
    </script>
    <div class="centered-div">
    <a href="javascript:play_date_sound();">Play sound</a>
    </div>

    <div class="centered-div">
    <a id="date-element"> DATE </a>
    </div>
    <button onclick="javascript:new_date_string();">Next Date</button>

    <div class="centered-div">
    <input type="checkbox" id="tts" name="tts" checked>
    <label for="tts">TTS?</label>
    </div>

    <div class="centered-div">
    <audio loop controls id="audio">
      <source src="silence.flac" type="audio/flac">
      Your browser does not support the audio element.
    </audio>
    </div>

    <div class="grid-container">
        <div>1</div>
        <div>2</div>
        <div>3</div>  
        <div>4</div>
        <div>5</div>
        <div>6</div>  
        <div></div>  
        <div>7</div>  
        <div></div>  
      </div>
</body>